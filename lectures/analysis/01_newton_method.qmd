---
title: "Newton's Method"
subtitle: "Analysis I ‚Äî Lecture 1"
author: "Erik An"
date: last-modified
format:
  live-html:
    theme:
      light: flatly
      dark: darkly
    css: styles.css
engine: knitr
toc: true
---

{{< include ../../_extensions/r-wasm/live/_knitr.qmd >}}

## 1. The Problem

We want to find $x^*$ such that $f(x^*) = 0$.

This is called **root finding** and appears constantly in mathematics:

- Solving equations
- Finding fixed points  
- Optimization (finding where $f'(x) = 0$)

**Example:** Find $\sqrt{2}$ by solving $f(x) = x^2 - 2 = 0$

---

## 2. The Idea Behind Newton's Method

**Key insight:** If we can't solve $f(x) = 0$ directly, we can *approximate* $f$ with something simpler.

The simplest approximation? A **straight line** (the tangent).

At any point $x_n$, the tangent line to $f$ is:

$$L(x) = f(x_n) + f'(x_n)(x - x_n)$$

Setting $L(x) = 0$ and solving for $x$:

$$x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$$

This is **Newton's Method**!

---

## 3. Interactive Python Code

The code blocks below are **fully interactive**. You can:

- ‚úèÔ∏è **Edit** the code
- ‚ñ∂Ô∏è **Run** it with the "Run Code" button
- üîÑ **Reset** to the original with "Start Over"

### Define the function

```{pyodide}
import numpy as np

# Define the function and its derivative
def f(x):
    return x**2 - 2

def f_prime(x):
    return 2 * x

# Test it
print(f"f(2) = {f(2)}")
print(f"f'(2) = {f_prime(2)}")
```

### Newton's Method Implementation

```{pyodide}
def newton_method(x0, n_iterations):
    """
    Apply Newton's method starting from x0.
    Returns list of all iterates.
    """
    history = [x0]
    x = x0
    
    for i in range(n_iterations):
        if abs(f_prime(x)) < 1e-10:
            print(f"Warning: derivative near zero at iteration {i}")
            break
        x = x - f(x) / f_prime(x)
        history.append(x)
    
    return history

# Try it! Change x0 or n_iterations and re-run
x0 = 2.0
n_iterations = 6

history = newton_method(x0, n_iterations)
print(f"Starting from x‚ÇÄ = {x0}")
print(f"Iterations: {history}")
print(f"Final approximation: {history[-1]}")
print(f"True ‚àö2 = {np.sqrt(2)}")
```

---

## 4. Experiment: Convergence Analysis

Try changing the starting point `x0` below and observe how the convergence changes:

```{pyodide}
# === EXPERIMENT: Change x0 and re-run! ===
x0 = 2.0  # Try: 1.5, 3.0, 0.5, -2.0

history = newton_method(x0, 8)
sqrt2 = np.sqrt(2)

print(f"{'n':<4} {'x_n':<22} {'Error':<15}")
print("-" * 45)

for i, x in enumerate(history):
    error = abs(x - sqrt2)
    if error < 1e-15:
        error_str = "< 1e-15"
    else:
        error_str = f"{error:.2e}"
    print(f"{i:<4} {x:<22.15f} {error_str:<15}")
```

---

## 5. Visualization

```{pyodide}
import matplotlib.pyplot as plt

# Run Newton's method
x0 = 2.0
history = newton_method(x0, 5)

# Create plot
fig, ax = plt.subplots(figsize=(10, 6))

# Plot function
x_range = np.linspace(-0.5, 3, 200)
ax.plot(x_range, f(x_range), 'b-', linewidth=2, label=r'$f(x) = x^2 - 2$')

# Plot tangent lines
for i in range(len(history) - 1):
    xi = history[i]
    yi = f(xi)
    slope = f_prime(xi)
    
    # Tangent line
    x_tan = np.linspace(xi - 1, xi + 1, 50)
    y_tan = yi + slope * (x_tan - xi)
    ax.plot(x_tan, y_tan, 'orange', alpha=0.6, linewidth=1)

# Plot iteration points
ax.scatter(history, [f(x) for x in history], c='red', s=80, 
           zorder=5, label='Iterations', edgecolors='darkred')

# Reference lines
ax.axvline(x=np.sqrt(2), color='green', linestyle=':', linewidth=2, label=r'$\sqrt{2}$')
ax.axhline(y=0, color='black', linewidth=0.5)

ax.set_xlabel('x')
ax.set_ylabel('y')
ax.set_title("Newton's Method: Finding ‚àö2")
ax.legend()
ax.grid(True, alpha=0.3)
ax.set_xlim(-0.5, 3)
ax.set_ylim(-3, 5)

plt.tight_layout()
plt.show()
```

---

## 6. What Happens at x‚ÇÄ = 0?

```{pyodide}
# What happens if we start at x0 = 0?
print(f"f(0) = {f(0)}")
print(f"f'(0) = {f_prime(0)}")
print()
print("The derivative is 0, so we would divide by zero!")
print("Newton's method fails at this starting point.")
```

---

## 7. Exercise: Find the Cube Root of 2

**Your task:** Modify the code below to find $\sqrt[3]{2}$ instead of $\sqrt{2}$.

Hint: You need to solve $g(x) = x^3 - 2 = 0$

```{pyodide}
# TODO: Modify these functions to find the cube root of 2
def g(x):
    return x**2 - 2  # Change this!

def g_prime(x):
    return 2 * x     # Change this!

# Newton's method for g
def newton_g(x0, n_iter):
    x = x0
    for _ in range(n_iter):
        x = x - g(x) / g_prime(x)
    return x

# Test your solution
result = newton_g(1.5, 10)
print(f"Your result: {result}")
print(f"True ‚àõ2 = {2**(1/3)}")
```

---

## 8. Summary

::: {.callout-note}
## Newton's Method Formula
$$x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$$
:::

### Key Properties

- **Quadratic convergence** near simple roots
- Requires **derivative** $f'(x)$
- Sensitive to **starting point**
- May fail if $f'(x_n) \approx 0$
